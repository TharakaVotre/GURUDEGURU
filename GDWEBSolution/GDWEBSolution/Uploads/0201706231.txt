Select B.BranchName,Invoiceno, CustomerName,
InvoiceDate,InvoiceValue,Discount,DiscountedInvoiceValue,
TotalInvoiceValue-DiscountedInvoiceValue as VATAmount,
A.CreatedBy as SystemOperator,
TotalInvoiceValue as GrandTotal,'Sender Paying' as InvoiceCategory
from tblCashInvoiceMaster A,tblBranch B
where A.Branch=B.BranchCode
and convert(varchar,InvoiceDate,112)>='20150601'
and convert(varchar,InvoiceDate,112)<='20150630'
union
Select B.BranchName,Invoiceno, ReceiverName as CustomerName,
InvoiceDate,InitialInvoiceValue as InvoiceValue,Discount,
InitialInvoiceValue-Discount as DiscountedInvoiceValue,
VATAmount,
[InvoicedBy] as SystemOperator,
TotalInvoiceValue as GrandTotal,
'Receiver Paying' as InvoiceCategory
from tblCashRPInvoice A,tblBranch B
where A.[InvoicingHub]=B.BranchCode
and convert(varchar,InvoiceDate,112)>='20150601'
and convert(varchar,InvoiceDate,112)<='20150630'
union
Select B.BranchName,Invoiceno, CustomerName,
InvoiceDate,Total as InvoiceValue,Discount,
DiscountedTotal as DiscountedInvoiceValue,
VATAmount,
Cashier as SystemOperator,
GrandTotal,
'Summary Invoice' as InvoiceCategory
from  [dbo].[tblCashSummaryInvoiceHeader] A,tblBranch B
where A.BranchCode=B.BranchCode
and convert(varchar,InvoiceDate,112)>='20150601'
and convert(varchar,InvoiceDate,112)<='20150630'

