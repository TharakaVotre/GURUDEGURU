
select sum(totalinvoicevalue) from 
(
select branchname,invoiceno,invoicedate,customername,totalinvoicevalue from tblcashinvoicemaster A, tblBranch B
where invoicedate>='01-sep-2015'
and invoicedate<='01-oct-2015'
and A.branch=B.branchcode
and invoiceno not in
(select invoiceno from tblcancelledinvoice)
and invoiceno in
(select invoiceno from tblacceptedcash where CashCollectedDate<'01-oct-2015')
union
select branchname,invoiceno,invoicedate,receivername,totalinvoicevalue from tblcashrpinvoice A, tblBranch B
where invoicedate>='01-sep-2015'
and invoicedate<='01-oct-2015'
and A.invoicinghub=B.branchcode
and invoiceno not in
(select invoiceno from tblcancelledinvoice)
and invoiceno in
(select invoiceno from tblacceptedcash where CashCollectedDate<'01-oct-2015')
union
select branchname,invoiceno,invoicedate,customername,grandtotal from 
[dbo].[tblCashSummaryInvoiceHeader] A, tblBranch B
where invoicedate>='01-sep-2015'
and invoicedate<='01-oct-2015'
and A.branchcode=B.branchcode
and invoiceno not in
(select invoiceno from tblcancelledinvoice)
and invoiceno in
(select invoiceno from tblacceptedcash where CashCollectedDate<'01-oct-2015')

)X
